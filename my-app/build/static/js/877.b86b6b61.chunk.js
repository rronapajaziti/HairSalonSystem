"use strict";(self.webpackChunktailadmin_react_free=self.webpackChunktailadmin_react_free||[]).push([[877],{877:(e,a,r)=>{r.r(a),r.d(a,{default:()=>m});var t=r(43),d=r(213),s=r(369),l=r(149),o=r(420),i=r(579);const m=e=>{let{searchQuery:a}=e;const[r,m]=(0,t.useState)([]),[n,x]=(0,t.useState)(!1),[b,c]=(0,t.useState)({id:null,firstName:"",lastName:"",phoneNumber:"",email:"",password:"",roleID:3}),[k,u]=(0,t.useState)(!1),[h,p]=(0,t.useState)(null),[N,g]=(0,t.useState)({id:null,firstName:"",lastName:"",phoneNumber:"",email:"",password:"",roleID:3}),[w,f]=(0,t.useState)(""),[j,y]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e=localStorage.getItem("adminToken");if(console.log("Admin Token:",e),e)try{const a=(0,o.s)(e);console.log("Decoded Token:",a);const r="1"===a.RolesID||"2"===a.RolesID;y(r),console.log("Is Authorized:",r)}catch(a){console.error("Error decoding token:",a),y(!1)}else y(!1);d.A.get("https://api.studio-linda.com/api/User",{headers:{Authorization:`Bearer ${e}`}}).then((e=>{const a=e.data.map((e=>({...e,id:e.userID})));m(a)})).catch((e=>{var a;401===(null===(a=e.response)||void 0===a?void 0:a.status)&&f("Ju nuk jeni t\xeb autorizuar p\xebr t\xeb kryer k\xebt\xeb veprim.")}))}),[]);const v=e=>{const{name:a,value:r}=e.target;c((e=>({...e,[a]:r})))},I=e=>{const{name:a,value:r}=e.target;g((e=>({...e,[a]:"roleID"===a?parseInt(r,10):r})))},S=e=>{e.preventDefault();const a=localStorage.getItem("adminToken"),r={userID:N.id,firstName:N.firstName,lastName:N.lastName,phoneNumber:N.phoneNumber,email:N.email,roleID:N.roleID,passwordHash:N.password||"defaultPasswordHash",passwordSalt:N.password||"defaultPasswordSalt"};d.A.put(`https://api.studio-linda.com/api/User/${r.userID}`,r,{headers:{Authorization:`Bearer ${a}`}}).then((()=>{m((e=>e.map((e=>e.id===r.userID?{...e,...r}:e)))),p(null),u(!1)}))},D=r.filter((e=>`${e.firstName} ${e.lastName}`.toLowerCase().includes(a.toLowerCase())));return(0,i.jsxs)("div",{className:"rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsx)("h1",{className:"text-xl font-semibold dark:text-white text-blue-900",children:"Staff"}),(0,i.jsx)("button",{onClick:()=>{x(!n),u(!1),c({id:null,firstName:"",lastName:"",phoneNumber:"",email:"",password:"",roleID:3})},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md",children:n?"X":"Shto Stafin"})]}),w&&(0,i.jsx)("div",{className:"text-red-500 text-center",children:w}),n&&(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault();const a=localStorage.getItem("adminToken"),r={userID:0,firstName:b.firstName,lastName:b.lastName,phoneNumber:b.phoneNumber,email:b.email,passwordHash:b.password,passwordSalt:"defaultSalt",roleID:b.roleID};d.A.post("https://api.studio-linda.com/api/User/register",r,{headers:{Authorization:`Bearer ${a}`}}).then((e=>{m((a=>[...a,e.data])),x(!1),c({id:null,firstName:"",lastName:"",phoneNumber:"",email:"",password:"",roleID:3})}))},className:"mt-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Emri"}),(0,i.jsx)("input",{type:"text",name:"firstName",placeholder:"First Name",value:b.firstName,onChange:v,required:!0,className:"px-4 py-2 border text-black border-gray-300 dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Mbiemri"}),(0,i.jsx)("input",{type:"text",name:"lastName",placeholder:"Last Name",value:b.lastName,onChange:v,required:!0,className:"px-4 py-2 border text-black border-gray-300 dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Numri i telefonit"}),(0,i.jsx)("input",{type:"text",name:"phoneNumber",placeholder:"Phone Number",value:b.phoneNumber,onChange:v,required:!0,className:"px-4 py-2 border text-black border-gray-300 dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Email"}),(0,i.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:b.email,onChange:v,required:!0,className:"px-4 py-2 border text-black border-gray-300 dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Password"}),(0,i.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:b.password,onChange:v,required:!0,className:"px-4 py-2 border text-black border-gray-300 dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark"})]})]}),(0,i.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md mt-4",disabled:!j,children:k?"Update Staff":"Shto"})]}),(0,i.jsx)("div",{className:"max-w-full overflow-x-auto mt-6",children:(0,i.jsxs)("table",{className:"w-full table-auto dark:border-strokedark dark:bg-boxdark",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"bg-gray-200 text-left",children:[(0,i.jsx)("th",{className:"py-4 px-4 text-blue-900 dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Emri dhe Mbiemri"}),(0,i.jsx)("th",{className:"py-4 px-4 text-blue-900 dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Numri i telefonit"}),(0,i.jsx)("th",{className:"py-4 px-4 text-blue-900 dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Email"}),(0,i.jsx)("th",{className:"py-4 px-4 text-blue-900 dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Veprimet"})]})}),(0,i.jsx)("tbody",{children:D.filter((e=>1!==e.roleID)).map((e=>(0,i.jsxs)(t.Fragment,{children:[(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-4 px-4 dark:text-white text-black",children:[e.firstName," ",e.lastName]}),(0,i.jsx)("td",{className:"py-4 px-4 dark:text-white text-black",children:e.phoneNumber}),(0,i.jsx)("td",{className:"py-4 px-4 dark:text-white text-black",children:e.email}),(0,i.jsx)("td",{className:"py-4 px-4",children:(0,i.jsxs)("div",{className:"flex space-x-2 sm:justify-center",children:[(0,i.jsx)("button",{onClick:()=>(e=>{h===e.id?p(null):(p(e.id),u(!0),g({id:e.id,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,email:e.email,password:"",roleID:e.roleID}))})(e),className:"bg-blue-500 text-white rounded-md px-4 py-2 text-base sm:px-4 sm:py-2 sm:text-sm",disabled:!j,children:(0,i.jsx)(s.uO9,{})}),(0,i.jsx)("button",{onClick:()=>(e=>{const a=localStorage.getItem("adminToken");d.A.delete(`https://api.studio-linda.com/api/User/${e}`,{headers:{Authorization:`Bearer ${a}`}}).then((()=>{m((a=>a.filter((a=>a.id!==e))))}))})(e.id),className:"bg-red-500 text-white rounded-md px-4 py-2 text-base sm:px-4 sm:py-2 sm:text-sm",disabled:!j,children:(0,i.jsx)(l.pS_,{})})]})})]}),h===e.id&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:4,className:"py-4 px-4 bg-gray-100 text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:(0,i.jsxs)("form",{onSubmit:S,children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Emri"}),(0,i.jsx)("input",{type:"text",name:"emri",value:N.firstName,onChange:I,className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Mbiemri"}),(0,i.jsx)("input",{type:"text",name:"mbiemri",value:N.lastName,onChange:I,className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Numri i telefonit"}),(0,i.jsx)("input",{type:"text",name:"phoneNumber",value:N.phoneNumber,onChange:I,className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Email"}),(0,i.jsx)("input",{type:"email",name:"email",value:N.email,onChange:I,className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:"Password"}),(0,i.jsx)("input",{type:"password",name:"password",value:N.password,onChange:I,className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",placeholder:"Leave blank to keep unchanged"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 text-black dark:text-white",children:"Roli"}),(0,i.jsxs)("select",{name:"roleID",value:N.roleID,onChange:e=>g({...N,roleID:parseInt(e.target.value,10)}),required:!0,className:"px-4 py-2 border text-black border-gray-300 dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark",children:[(0,i.jsx)("option",{value:1,children:"Admin"}),(0,i.jsx)("option",{value:2,children:"Owner"}),(0,i.jsx)("option",{value:3,children:"Staff"})]})]})]}),(0,i.jsx)("button",{type:"submit",className:"mt-4 px-4 py-2 bg-blue-900 text-white rounded-md",disabled:!j,children:"Ruaj"})]})})})]},e.id)))})]})})]})}}}]);
//# sourceMappingURL=877.b86b6b61.chunk.js.map