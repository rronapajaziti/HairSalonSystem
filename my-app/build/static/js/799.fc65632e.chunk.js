"use strict";(self.webpackChunktailadmin_react_free=self.webpackChunktailadmin_react_free||[]).push([[799],{799:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(43),s=a(213),d=a(369),i=a(149),n=a(579);const c=e=>{let{updateServiceList:t,searchQuery:a}=e;const[c,l]=(0,r.useState)([]),[o,x]=(0,r.useState)([]),[u,b]=(0,r.useState)({serviceID:[],discountPercentage:"",startDate:"",endDate:""}),[m,p]=(0,r.useState)(null),[k,h]=(0,r.useState)({serviceDiscountID:"",serviceID:[],discountPercentage:"",startDate:"",endDate:""}),[D,v]=(0,r.useState)(!1);(0,r.useEffect)((()=>{g(),j()}),[]);const g=async()=>{try{const e=await s.A.get("https://api.studio-linda.com/api/ServiceDiscount");l(e.data)}catch(e){console.error("Error fetching discounts:",e)}},j=async()=>{try{const e=await s.A.get("https://api.studio-linda.com/api/Service");x(e.data)}catch(e){console.error("Error fetching services:",e)}},y=async e=>{e.preventDefault();try{if(!k.startDate||!k.endDate)return void alert("Dates cannot be empty.");const e=new Date(k.startDate+"T00:00:00"),a=new Date(k.endDate+"T00:00:00");if(isNaN(e.getTime())||isNaN(a.getTime()))return void alert("Invalid date format. Please ensure the dates are valid.");if(e>=a)return void alert("Start date must be earlier than the end date.");const r={serviceDiscountID:m,serviceIDs:k.serviceID.map((e=>parseInt(e,10))),discountPercentage:parseFloat(k.discountPercentage),startDate:e.toISOString(),endDate:a.toISOString()};await s.A.put(`https://api.studio-linda.com/api/ServiceDiscount/${m}`,r),l((e=>e.map((e=>e.serviceDiscountID===m?{...e,...r}:e)))),p(null),t()}catch(a){console.error("Error updating discount:",a),alert("Error updating discount. Please try again.")}},w=c.filter((e=>e.serviceIDs.map((e=>{const t=o.find((t=>t.serviceID===e));return(null===t||void 0===t?void 0:t.serviceName.toLowerCase())||""})).join(", ").includes(a.toLowerCase()))),N=w.filter((e=>new Date(e.startDate)<=new Date&&new Date(e.endDate)>=new Date)),f=w.filter((e=>new Date(e.endDate)<new Date||new Date(e.startDate)>new Date)),I=(e,a)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2 dark:text-white text-blue-900",children:a}),(0,n.jsxs)("table",{className:"w-full border-collapse border mb-6 text-black dark:text-white rounded-md w-full dark:border-strokedark dark:bg-boxdark",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"border px-4 py-2 dark:border-strokedark dark:bg-boxdark text-black dark:text-white",children:"Sh\xebrbimi"}),(0,n.jsx)("th",{className:"border px-4 py-2 dark:border-strokedark dark:bg-boxdark text-black dark:text-white",children:"\xc7mimi Aktual"}),(0,n.jsx)("th",{className:"border px-4 py-2 dark:border-strokedark dark:bg-boxdark text-black dark:text-white",children:"Zbritja (%)"}),(0,n.jsx)("th",{className:"border px-4 py-2 dark:border-strokedark dark:bg-boxdark text-black dark:text-white",children:"Data e Fillimit"}),(0,n.jsx)("th",{className:"border px-4 py-2 dark:border-strokedark dark:bg-boxdark text-black dark:text-white",children:"Data e Mbarimit"}),(0,n.jsx)("th",{className:"border px-4 py-2 dark:border-strokedark dark:bg-boxdark text-black dark:text-white",children:"Veprimet"})]})}),(0,n.jsx)("tbody",{children:e.map((e=>{var a,c;return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border px-4 py-2",children:(null===(a=e.serviceIDs)||void 0===a?void 0:a.map((e=>{const t=o.find((t=>t.serviceID===e));return(null===t||void 0===t?void 0:t.serviceName)||"I panjohur"})).join(", "))||"I panjohur"}),(0,n.jsx)("td",{className:"border px-4 py-2",children:(null===(c=e.serviceIDs)||void 0===c?void 0:c.map((e=>{const t=o.find((t=>t.serviceID===e));return(null===t||void 0===t?void 0:t.price)||"I panjohur"})).join(", "))||"I panjohur"}),(0,n.jsxs)("td",{className:"border px-4 py-2",children:[e.discountPercentage,"%"]}),(0,n.jsx)("td",{className:"border px-4 py-2",children:new Date(e.startDate).toLocaleDateString()}),(0,n.jsx)("td",{className:"border px-4 py-2",children:new Date(e.endDate).toLocaleDateString()}),(0,n.jsx)("td",{className:"py-4 px-4",children:(0,n.jsxs)("div",{className:"flex space-x-2 sm:justify-center",children:[(0,n.jsx)("button",{onClick:()=>(e=>{m===e.serviceDiscountID?p(null):(p(e.serviceDiscountID),h({serviceDiscountID:e.serviceDiscountID,serviceID:e.serviceIDs.map((e=>e.toString())),discountPercentage:e.discountPercentage.toString(),startDate:e.startDate.split("T")[0],endDate:e.endDate.split("T")[0]}))})(e),className:"bg-blue-500 text-white rounded-md px-4 py-2 text-base sm:px-4 sm:py-2 sm:text-sm",children:(0,n.jsx)(d.uO9,{})}),(0,n.jsx)("button",{onClick:()=>(async e=>{try{await s.A.delete(`https://api.studio-linda.com/api/ServiceDiscount/${e}`),l((t=>t.filter((t=>t.serviceDiscountID!==e)))),t()}catch(a){console.error("Error deleting discount:",a)}})(e.serviceDiscountID),className:"bg-red-500 text-white rounded-md px-4 py-2 text-base sm:px-4 sm:py-2 sm:text-sm",children:(0,n.jsx)(i.pS_,{})})]})})]}),m===e.serviceDiscountID&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:6,className:"py-4 px-4 bg-gray-100 dark:bg-boxdark",children:(0,n.jsxs)("form",{onSubmit:y,children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Sh\xebrbimet"}),(0,n.jsx)("select",{name:"serviceID",value:k.serviceID,onChange:e=>h({...k,serviceID:Array.from(e.target.selectedOptions).map((e=>e.value))}),multiple:!0,className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",children:o.map((e=>(0,n.jsx)("option",{value:e.serviceID,children:e.serviceName},e.serviceID)))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Zbritja (%)"}),(0,n.jsx)("input",{type:"number",name:"discountPercentage",value:k.discountPercentage,onChange:e=>h({...k,discountPercentage:e.target.value}),className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Data e Fillimit"}),(0,n.jsx)("input",{type:"date",name:"startDate",value:k.startDate,onChange:e=>h({...k,startDate:e.target.value}),className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white",children:"Data e Mbarimit"}),(0,n.jsx)("input",{type:"date",name:"endDate",value:k.endDate,onChange:e=>h({...k,endDate:e.target.value}),className:"px-4 py-2 border rounded-md w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark",required:!0})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,n.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md",children:"Ruaj"}),(0,n.jsx)("button",{type:"button",onClick:()=>p(null),className:"px-4 py-2 bg-gray-400 text-white rounded-md",children:"Anulo"})]})]})})})]},e.serviceDiscountID)}))})]})]});return(0,n.jsxs)("div",{className:"container mx-auto p-4 dark:text-white text-blue-900",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4 ",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold dark:text-white text-blue-900",children:"Menaxhimi i Zbritjeve"}),(0,n.jsx)("button",{onClick:()=>v(!D),className:"bg-blue-500 text-white px-4 py-2 rounded",children:D?"X":"Shto Zbritje"})]}),D&&(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a={serviceIDs:u.serviceID.map((e=>parseInt(e,10))),discountPercentage:parseFloat(u.discountPercentage),startDate:new Date(u.startDate+"T00:00:00").toISOString(),endDate:new Date(u.endDate+"T00:00:00").toISOString()};try{const e=await s.A.post("https://api.studio-linda.com/api/ServiceDiscount",a);l([...c,e.data]),v(!1),b({serviceID:[],discountPercentage:"",startDate:"",endDate:""}),t()}catch(r){console.error("Error adding discount:",r)}},className:"mb-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 ",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium",children:"Sh\xebrbimet"}),(0,n.jsx)("select",{multiple:!0,value:u.serviceID,onChange:e=>b({...u,serviceID:Array.from(e.target.selectedOptions).map((e=>e.value))}),className:"border rounded px-2 py-1 w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark ",children:o.map((e=>(0,n.jsx)("option",{value:e.serviceID,children:e.serviceName},e.serviceID)))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium",children:"Zbritja (%)"}),(0,n.jsx)("input",{type:"number",value:u.discountPercentage,onChange:e=>b({...u,discountPercentage:e.target.value}),className:"border rounded px-2 py-1 w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium",children:"Data e Fillimit"}),(0,n.jsx)("input",{type:"date",value:u.startDate,onChange:e=>b({...u,startDate:e.target.value}),className:"border rounded px-2 py-1 w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium",children:"Data e Mbarimit"}),(0,n.jsx)("input",{type:"date",value:u.endDate,onChange:e=>b({...u,endDate:e.target.value}),className:"border rounded px-2 py-1 w-full text-black dark:text-white dark:border-strokedark dark:bg-boxdark"})]})]}),(0,n.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded mt-4",children:"Shto Zbritje"})]}),I(N,"Zbritjet Aktive"),I(f,"Zbritjet Joaktive")]})}}}]);
//# sourceMappingURL=799.fc65632e.chunk.js.map